apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: minio-tenant
  namespace: minio
spec:
  interval: 10m
  chart:
    spec:
      chart: tenant
      version: "7.1.1"
      sourceRef:
        kind: HelmRepository
        name: minio-operator
        namespace: flux-system
      interval: 10m
  values:
    tenant:
      name: minio
      configSecret:
        name: env-config
        existingSecret: true
      # configuration:
      #   name: env-config
      # pools:
      #   - name: pool-0
      #     servers: 1
      # features:
      #   - name: loki-admin
      #   - name: loki-chunks
      #   - name: loki-ruler
      #   - name: mimir-ruler
      #   - name: mimir-tsdb


# apiVersion: minio.min.io/v2
# kind: Tenant
# metadata:
#   name: minio
#   namespace: minio
# spec:
#   users:
#     - name: loki
#   configuration:
#     name: storage-configuration
#   requestAutoCert: false
#   pools:
#     - name: grafana
#       servers: 1
#       volumesPerServer: 1
#       storageClass: delete
#       volumeClaimTemplate:
#         metadata:
#           name: data
#         spec:
#           accessModes:
#             - ReadWriteOnce
#           resources:
#             requests:
#               storage: 2Gi
#       containerSecurityContext:
#         runAsUser: 1000
#         runAsGroup: 1000
#         runAsNonRoot: true
#         allowPrivilegeEscalation: false
#         capabilities:
#           drop:
#             - ALL
#         seccompProfile:
#           type: RuntimeDefault




#   values:
#     tenant:
#       pools:
#         - name: pool-0
#           servers: 1
#           storageClass: delete
#           volumePerServer: 4